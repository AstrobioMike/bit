# bit-cov-analyzer

## have the core framework done, need to add thresholds options
    # i'm thinking one for high and one for low, and that using fold-change works best
    # as it's intuitive to the user, but inside, when wanting to use it for lower values
    # we'll convert it to log2fold change so we can filter on that

    # implement the thresholds, and then sent to GDNA to start trying it on "10 seeds"


## making small test data with 10X higher coverage in one area

# getting a genome
wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/005/845/GCF_000005845.2_ASM584v2/GCF_000005845.2_ASM584v2_genomic.fna.gz

gunzip GCF_000005845.2_ASM584v2_genomic.fna.gz

# making 2 small contigs
head -n 6001 GCF_000005845.2_ASM584v2_genomic.fna | tail -n +2 > mock-c1.fa
sed -n '6002,12001p' GCF_000005845.2_ASM584v2_genomic.fna > mock-c2.fa
    # manually added headers
cat mock-c1.fa mock-c2.fa > mock.fasta

# making a 2000 bp region of one of those to make higher coverage for
sed -n '2000,2024p' mock.fasta > higher-region.fasta
    # manually added a header

rm GCF_000005845.2_ASM584v2_genomic.fna mock-c1.fa mock-c2.fa

# making reads
bit-gen-reads -i mock.fasta -n 64000 -o initial-reads
bit-gen-reads -i higher-region.fasta -n 1400 -o higher-cov-reads

cat initial-reads_R1.fastq.gz higher-cov-reads_R1.fastq.gz > mock-reads-R1.fq.gz
cat initial-reads_R2.fastq.gz higher-cov-reads_R2.fastq.gz > mock-reads-R2.fq.gz

rm initial-reads_R* higher-cov-reads_R*

# mapping
cda magrec-mapping

bowtie2-build mock.fasta mock
bowtie2 -x mock -1 mock-reads-R1.fq.gz -2 mock-reads-R2.fq.gz | samtools view -b | samtools sort -o mock.bam
samtools index mock.bam

cda bit
mosdepth --by 100 100 mock.bam

